"use strict";(self.webpackChunkstreamlit_geomap_frontend=self.webpackChunkstreamlit_geomap_frontend||[]).push([[2544,6070],{11668:(e,a,r)=>{r.d(a,{K:()=>w,Q:()=>o});var t=r(53986),n=r(31933),l=r(67061);const i=["loadContext"],s=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function o(e,a){var r,s;const o=a||{},{loadContext:u}=o,c=(0,t.A)(o,i),y=u?await u.fetchServiceMetadata(e,c):await(0,l.V)(e,c),f=(0,n.G$)();v(y),d(y);const w={serviceJSON:y,preferredHost:f};if((null!==(r=y.currentVersion)&&void 0!==r?r:0)<10.5)return w;const h="".concat(null!==(s=(0,n.$x)())&&void 0!==s?s:e,"/layers"),m=u?await u.fetchServiceMetadata(h,c):await(0,l.V)(h,c);return v(m),d(m),w.layersJSON={layers:m.layers,tables:m.tables},w}function u(e){const{type:a}=e;return!!a&&s.has(a)}function c(e){return"Table"===e.type}function d(e){var a,r;e.layers=null===(a=e.layers)||void 0===a?void 0:a.filter(u),e.tables=null===(r=e.tables)||void 0===r?void 0:r.filter(c)}function y(e){e.type||(e.type="Feature Layer")}function f(e){e.type||(e.type="Table")}function v(e){var a,r;null!==(a=e.layers)&&void 0!==a&&a.forEach(y),null===(r=e.tables)||void 0===r||r.forEach(f)}function w(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},39323:(e,a,r)=>{r.d(a,{L:()=>d});var t=r(89379),n=r(55171),l=r(3825),i=r(50076),s=r(50346),o=r(13096),u=r(65308),c=r(70652);async function d(e,a){var r,d;const v=(0,o.qg)(e);if(!v)throw new i.A("invalid-url","Invalid scene service url");const w=(0,t.A)((0,t.A)({},a),{},{sceneServerUrl:v.url.path,layerId:null!==(r=v.sublayer)&&void 0!==r?r:void 0});if(null!==(d=w.sceneLayerItem)&&void 0!==d||(w.sceneLayerItem=await async function(e){const a=(await y(e)).serviceItemId;if(!a)return null;const r=new c.default({id:a,apiKey:e.apiKey}),t=await async function(e){const a=null===n.id||void 0===n.id?void 0:n.id.findServerInfo(e.sceneServerUrl);if(null!==a&&void 0!==a&&a.owningSystemUrl)return a.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await(0,l.A)(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(h){(0,s.QP)(h)}return null}(e);null!=t&&(r.portal=new u.A({url:t}));try{return await r.load({signal:e.signal})}catch(m){return(0,s.QP)(m),null}}(w)),null==w.sceneLayerItem)return f(w.sceneServerUrl.replace("/SceneServer","/FeatureServer"),w);const h=await async function(e){let{sceneLayerItem:a,signal:r}=e;if(!a)return null;try{const e=(await a.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:r})).find(e=>"Feature Service"===e.type)||null;if(!e)return null;const t=new c.default({portal:e.portal,id:e.id});return await t.load(),t}catch(t){return(0,s.QP)(t),null}}(w);if(null===h||void 0===h||!h.url)throw new i.A("related-service-not-found","Could not find feature service through portal item relationship");w.featureServiceItem=h;const m=await f(h.url,w);return m.portalItem=h,m}async function y(e){if(e.rootDocument)return e.rootDocument;const a={query:(0,t.A)((0,t.A)({f:"json"},e.customParameters),{},{token:e.apiKey}),responseType:"json",signal:e.signal};try{const r=await(0,l.A)(e.sceneServerUrl,a);e.rootDocument=r.data}catch(r){e.rootDocument={}}return e.rootDocument}async function f(e,a){var r,n,s;const u=(0,o.qg)(e);if(!u)throw new i.A("invalid-feature-service-url","Invalid feature service url");const c=u.url.path,d=a.layerId;if(null==d)return{serverUrl:c};const f=y(a),v=a.featureServiceItem?await a.featureServiceItem.fetchData("json"):null,w=null===(r=(null===v||void 0===v||null===(n=v.layers)||void 0===n?void 0:n[0])||(null===v||void 0===v||null===(s=v.tables)||void 0===s?void 0:s[0]))||void 0===r?void 0:r.customParameters,h=e=>{const r={query:(0,t.A)({f:"json"},w),responseType:"json",authMode:e,signal:a.signal};return(0,l.A)(c,r)},m=h("anonymous").catch(()=>h("no-prompt")),[p,b]=await Promise.all([m,f]),L=null===b||void 0===b?void 0:b.layers,S=p.data&&p.data.layers;if(!Array.isArray(S))throw new Error("expected layers array");if(Array.isArray(L)){for(let t=0;t<Math.min(L.length,S.length);t++)if(L[t].id===d)return{serverUrl:c,layerId:S[t].id}}else if(null!=d&&d<S.length)return{serverUrl:c,layerId:S[d].id};throw new Error("could not find matching associated sublayer")}},62487:(e,a,r)=>{r.d(a,{S:()=>t});const t={BingMapsLayer:async()=>(await r.e(3993).then(r.bind(r,13993))).default,BuildingSceneLayer:async()=>(await Promise.all([r.e(9592),r.e(326),r.e(260),r.e(809),r.e(9905),r.e(188)]).then(r.bind(r,30188))).default,CSVLayer:async()=>(await r.e(1365).then(r.bind(r,1365))).default,CatalogLayer:async()=>(await Promise.all([r.e(8618),r.e(2003),r.e(9122),r.e(7872),r.e(6200),r.e(4397)]).then(r.bind(r,84397))).default,DimensionLayer:async()=>(await r.e(2798).then(r.bind(r,72798))).default,ElevationLayer:async()=>(await r.e(3875).then(r.bind(r,43875))).default,FeatureLayer:async()=>(await Promise.resolve().then(r.bind(r,38451))).default,GeoJSONLayer:async()=>(await r.e(709).then(r.bind(r,50709))).default,GeoRSSLayer:async()=>(await r.e(2551).then(r.bind(r,52551))).default,GroupLayer:async()=>(await Promise.all([r.e(2620),r.e(6095)]).then(r.bind(r,16095))).default,ImageryLayer:async()=>(await Promise.all([r.e(4439),r.e(9122),r.e(3092),r.e(6964),r.e(8307),r.e(2826),r.e(8580)]).then(r.bind(r,43052))).default,ImageryTileLayer:async()=>(await Promise.all([r.e(4439),r.e(3092),r.e(9844),r.e(6964),r.e(8307),r.e(1633),r.e(2826),r.e(7933),r.e(9237)]).then(r.bind(r,49237))).default,IntegratedMesh3DTilesLayer:async()=>(await r.e(6790).then(r.bind(r,76790))).default,IntegratedMeshLayer:async()=>(await Promise.all([r.e(260),r.e(5950)]).then(r.bind(r,35950))).default,KMLLayer:async()=>(await r.e(1324).then(r.bind(r,41324))).default,KnowledgeGraphLayer:async()=>(await Promise.all([r.e(8618),r.e(8519),r.e(8683),r.e(2003),r.e(4439),r.e(8094),r.e(8026),r.e(2674),r.e(6570)]).then(r.bind(r,26570))).default,LineOfSightLayer:async()=>(await Promise.all([r.e(3900),r.e(4928)]).then(r.bind(r,24928))).default,LinkChartLayer:async()=>(await Promise.all([r.e(8618),r.e(8519),r.e(8683),r.e(2003),r.e(4439),r.e(8094),r.e(8026),r.e(2674),r.e(7079)]).then(r.bind(r,17079))).default,MapImageLayer:async()=>(await Promise.all([r.e(8618),r.e(9122),r.e(7872),r.e(5721),r.e(7113)]).then(r.bind(r,82951))).default,MapNotesLayer:async()=>(await r.e(3311).then(r.bind(r,43311))).default,MediaLayer:async()=>(await r.e(9522).then(r.bind(r,39522))).default,OGCFeatureLayer:async()=>(await Promise.all([r.e(8618),r.e(6799),r.e(9548)]).then(r.bind(r,1741))).default,OpenStreetMapLayer:async()=>(await r.e(803).then(r.bind(r,50803))).default,OrientedImageryLayer:async()=>(await r.e(3832).then(r.bind(r,3832))).default,PointCloudLayer:async()=>(await Promise.all([r.e(260),r.e(1830)]).then(r.bind(r,11830))).default,RouteLayer:async()=>(await Promise.all([r.e(1297),r.e(5534)]).then(r.bind(r,5534))).default,SceneLayer:async()=>(await Promise.all([r.e(9592),r.e(326),r.e(260),r.e(809),r.e(9905),r.e(6105)]).then(r.bind(r,16105))).default,StreamLayer:async()=>(await r.e(4369).then(r.bind(r,84369))).default,SubtypeGroupLayer:async()=>(await Promise.all([r.e(4439),r.e(6061)]).then(r.bind(r,86061))).default,TileLayer:async()=>(await Promise.all([r.e(8618),r.e(9122),r.e(7872),r.e(5721),r.e(2374)]).then(r.bind(r,71174))).default,UnknownLayer:async()=>(await r.e(8896).then(r.bind(r,8896))).default,UnsupportedLayer:async()=>(await r.e(2043).then(r.bind(r,72043))).default,VectorTileLayer:async()=>(await Promise.all([r.e(5995),r.e(3134)]).then(r.bind(r,53451))).default,VideoLayer:async()=>(await Promise.all([r.e(4439),r.e(6277)]).then(r.bind(r,96277))).default,ViewshedLayer:async()=>(await Promise.all([r.e(3900),r.e(8532)]).then(r.bind(r,78532))).default,VoxelLayer:async()=>(await Promise.all([r.e(260),r.e(8560)]).then(r.bind(r,88560))).default,WCSLayer:async()=>(await Promise.all([r.e(4439),r.e(3092),r.e(9844),r.e(6964),r.e(8307),r.e(1633),r.e(2826),r.e(7933),r.e(9954)]).then(r.bind(r,29954))).default,WFSLayer:async()=>(await Promise.all([r.e(1316),r.e(4583)]).then(r.bind(r,26964))).default,WMSLayer:async()=>(await r.e(2015).then(r.bind(r,52015))).default,WMTSLayer:async()=>(await r.e(1845).then(r.bind(r,1845))).default,WebTileLayer:async()=>(await r.e(4552).then(r.bind(r,24552))).default}},62544:(e,a,r)=>{r.r(a),r.d(a,{fromUrl:()=>f});var t=r(89379),n=r(50076),l=r(90534),i=r(13096),s=r(39323),o=r(11668),u=r(31933),c=r(62487),d=r(67061);const y={FeatureLayer:!0,SceneLayer:!0,VideoLayer:!0};async function f(e){const{properties:a,url:c}=e,f=(0,t.A)((0,t.A)({},a),{},{url:c}),p=await async function(e,a){let r=(0,i.qg)(e);if(null==r&&(r=await async function(e,a){var r,t;const n=await(0,d.V)(e,{customParameters:a});let s=null,o=null;const u=n.type;if("Feature Layer"===u||"Table"===u?(s="FeatureServer",o=null!==(r=n.id)&&void 0!==r?r:null):"indexedVector"===u?s="VectorTileServer":n.hasOwnProperty("mapName")?s="MapServer":n.hasOwnProperty("bandCount")&&n.hasOwnProperty("pixelSizeX")?s="ImageServer":n.hasOwnProperty("maxRecordCount")&&n.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":n.hasOwnProperty("streamUrls")?s="StreamServer":h(n)?(s="SceneServer",o=n.id):n.hasOwnProperty("layers")&&h(null===(t=n.layers)||void 0===t?void 0:t[0])&&(s="SceneServer"),!s)return null;const c=null!=o?(0,i.iz)(e):null;return{title:null!=c&&n.name||(0,l.e7)(e),serverType:s,sublayer:o,url:{path:null!=c?c.serviceUrl:(0,l.An)(e).path}}}(e,a)),null==r)throw new n.A("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:t,sublayer:c}=r;let f;const v={FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"},w="FeatureServer"===t,p="SceneServer"===t,b={parsedUrl:r,Constructor:null,layerId:(w||p)&&null!==c&&void 0!==c?c:void 0,layers:[],tables:[]};switch(t){case"MapServer":if(null!=c){const{type:r}=await(0,d.V)(e,{customParameters:a});switch(f="FeatureLayer",r){case"Catalog Layer":f="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new n.A("arcgis-layers:unsupported",'fromUrl() not supported for "'.concat(r,'" layers'))}}else f=await async function(e,a){return(await(0,d.V)(e,{customParameters:a})).tileInfo}(e,a)?"TileLayer":"MapImageLayer";break;case"ImageServer":{var L;const r=await(0,d.V)(e,{customParameters:a}),{tileInfo:t,cacheType:n}=r;f=t?"LERC"!==(null===t||void 0===t||null===(L=t.format)||void 0===L?void 0:L.toUpperCase())||n&&"elevation"!==n.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const e=await(0,d.V)(r.url.path,{customParameters:a});if(f="SceneLayer",e){const a=null===e||void 0===e?void 0:e.layers;if("Voxel"===(null===e||void 0===e?void 0:e.layerType))f="VoxelLayer";else if(null!==a&&void 0!==a&&a.length){var S;const e=null===(S=a[0])||void 0===S?void 0:S.layerType;null!=e&&null!=u.XX[e]&&(f=u.XX[e])}}break}case"3DTilesServer":throw new n.A("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(f="FeatureLayer",null!=c){const r=await(0,d.V)(e,{customParameters:a});b.sourceJSON=r,b.preferredUrl=(0,u.$x)(),f=(0,o.K)(r.type)}break;default:f=v[t]}if(y[f]&&null==c){var g;const r=await async function(e,a,r){var t,n;let l,i,c,y=!1;switch(a){case"FeatureServer":{const a=await(0,o.Q)(e,{customParameters:r});c=(0,u.$x)(e,{preferredHost:a.preferredHost}),y=!!a.layersJSON,l=a.layersJSON||a.serviceJSON;break}case"SceneServer":{const a=await async function(e,a){var r;const t=await(0,d.V)(e,{customParameters:a}),n=null===(r=t.layers)||void 0===r?void 0:r[0];if(!n)return{serviceInfo:t};try{const{serverUrl:r}=await(0,s.L)(e),n=await(0,d.V)(r,{customParameters:a}).catch(()=>null);return n&&(t.tables=n.tables),{serviceInfo:t,tableServerUrl:r}}catch(l){return{serviceInfo:t}}}(e,r);l=a.serviceInfo,i=a.tableServerUrl;break}default:l=await(0,d.V)(e,{customParameters:r})}const f=null===(t=l)||void 0===t?void 0:t.layers,v=null===(n=l)||void 0===n?void 0:n.tables;return{preferredUrl:c,layers:(null===f||void 0===f?void 0:f.map(e=>({id:e.id})).reverse())||[],tables:(null===v||void 0===v?void 0:v.map(e=>({serverUrl:i,id:e.id})).reverse())||[],layerInfos:y?f:[],tableInfos:y?v:[]}}(e,t,a);if(w&&(b.preferredUrl=r.preferredUrl,b.sublayerInfos=r.layerInfos,b.tableInfos=r.tableInfos),1!==r.layers.length+r.tables.length)b.layers=r.layers,b.tables=r.tables,w&&(null===(g=r.layerInfos)||void 0===g?void 0:g.length)&&(b.sublayerConstructorProvider=await async function(e){if(!e.length)return;const a=new Set,r=[];for(const{type:l}of e)a.has(l)||(a.add(l),r.push(m((0,o.K)(l))));const t=await Promise.all(r),n=new Map;return Array.from(a).forEach((e,a)=>{n.set(e,t[a])}),e=>n.get(e.type)}(r.layerInfos));else if(w||p){var I,P,U,T,A,C;const e=null!==(I=null===(P=r.layerInfos)||void 0===P?void 0:P[0])&&void 0!==I?I:null===(U=r.tableInfos)||void 0===U?void 0:U[0];if(b.layerId=null!==(T=null===(A=r.layers[0])||void 0===A?void 0:A.id)&&void 0!==T?T:null===(C=r.tables[0])||void 0===C?void 0:C.id,b.sourceJSON=e,w){const a=null===e||void 0===e?void 0:e.type;f=(0,o.K)(a)}}}return b.Constructor=await m(f),b}(c,null===a||void 0===a?void 0:a.customParameters),{Constructor:b,layerId:L,sourceJSON:S,parsedUrl:g,layers:I,tables:P}=p;if(I.length+P.length===0)return null!=L&&(f.layerId=L),null!=S&&(f.sourceJSON=S),new b(f);const U=new(0,(await Promise.all([r.e(2620),r.e(6095)]).then(r.bind(r,16095))).default)({title:g.title});return await async function(e,a,r){const t=a.sublayerConstructorProvider;for(const{id:l,serverUrl:i}of a.layers){var n;const s=v(a.sublayerInfos,l),o=w(i,l,s,null!==(n=s&&(null===t||void 0===t?void 0:t(s)))&&void 0!==n?n:a.Constructor,r);e.add(o)}if(a.tables.length){const t=await m("FeatureLayer");a.tables.forEach(n=>{let{id:l,serverUrl:i}=n;const s=w(i,l,v(a.tableInfos,l),t,r);e.tables.add(s)})}}(U,p,f),U}function v(e,a){return e?e.find(e=>{let{id:r}=e;return r===a}):null}function w(e,a,r,n,l){const i=(0,t.A)((0,t.A)({},l),{},{layerId:a});return null!=e&&(i.url=e),null!=r&&(i.sourceJSON=r),"sublayerTitleMode"in n.prototype&&(i.sublayerTitleMode="service-name"),new n(i)}function h(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function m(e){return(0,c.S[e])()}},67061:(e,a,r)=>{r.d(a,{V:()=>l});var t=r(89379),n=r(3825);async function l(e,a){const{data:r}=await(0,n.A)(e,{responseType:"json",query:(0,t.A)((0,t.A)({f:"json"},null===a||void 0===a?void 0:a.customParameters),{},{token:null===a||void 0===a?void 0:a.apiKey})});return r}}}]);
//# sourceMappingURL=2544.3d8e9256.chunk.js.map